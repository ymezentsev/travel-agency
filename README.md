# Travel agency

Spring Web Application based on Spring Boot and Java. This project is a REST API service for a travel agency. 
Depending on the role, users can perform various functions.

An unauthorized user can only view information about existing available tours, search for tours by name, 
maximum and minimum price, tour type, hotel type, transfer type, arrival date, and the "HOT" status of a tour. 
He can also register and recover a forgotten password.

A user with the "USER" role can additionally book and pay for tours, cancel a tour reservation and view information 
about all his tours. The user can change personal data, top up his balance and change his password.

A user with the "MANAGER" role can view not only available tours, but also reserved, paid and canceled ones. 
He can mark a tour as "HOT", "PAID" or "CANCELED". Also, he can view all tours of a specific user.

A user with the "ADMIN" role can add, edit and delete tours. The administrator also can see information about 
all users, search them by username, phone, email, role and status. He can change user’s role, block/unblock users.

The users receive a notification by email when they reserved, paid or canceled tours. A notification also comes 
2 days before departure on the tour. An automatic change of the tour to “HOT” on the day of departure with a 20% 
price reduction has been set up, as well as a change of the tour status to “NOT_SOLD” after the day of arrival 
on the tour has expired.

To view web-version of the application (when app running) follow the
link [Travel-agency](http://localhost:8080/v1/users/anonymous)

To view and test the application in Postman, you need to import the collection of requests from the "
Travel Agency.postman_collection.json" file.

Generated OpenApi documentation avaliable (when app running) [Swagger-ui](http://localhost:8080/swagger-ui/index.html)
and [OAS](http://localhost:8080/v3/api-docs)


## Getting Started
To run this project, you need to have the following software installed on your computer:
- JDK 17
- PostgreSQL

## Environment Variables
You must add the file `secret.properties`in the `src/main/resources` directory, and add the following environment
variables:

#### `spring.datasource.password`:
- The password of your PostgreSQL user.

#### `spring.mail.username`:
- Your email address used for sending emails.

#### `spring.mail.password`:
- The app-specific password generated by your email provider.
- For Gmail, you can create this password under your Google Account settings (`Security > App Passwords`).

#### `email.sender.login`:
- The name that will be displayed in the sender field of your emails.

#### `jwt.secret`:
- A secret key for signing JWT tokens.
- You can generate an appropriate jwt secret using:
```bash
  openssl rand -base64 129 | tr -d '\n'
  ```

## Running the Project
```mvn spring-boot:run```

## Tech stack
- Spring Boot
- Spring Data JPA
- Spring MVC
- Spring Security
- Spring AOP
- JWT
- Java Mail Sender
- PostgreSQL
- Swagger/OpenApi 3.0
- JUnit 5
- Lombok
- MapStruct
- Thymeleaf
- Bootstrap